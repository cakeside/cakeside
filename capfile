load 'deploy' if respond_to?(:namespace) # cap2 differentiator
#load 'deploy/assets'
Dir['vendor/gems/*/recipes/*.rb','vendor/plugins/*/recipes/*.rb'].each { |plugin| load(plugin) }
load 'config/deploy' # remove this line to skip loading any of the default tasks

task :search_libs, :roles => :web do
  run "ls -x1 /usr/lib | grep -i xml"
end

task :count_libs, :roles => :web do
  run "ls -x1 /usr/lib | wc -l"
end

task :show_free_space, :roles => :web do
  run "df -h /"
end

task :stop_sphinx , :roles => :app do
  run "cd #{current_path} && rake thinking_sphinx:stop RAILS_ENV=production"
end

task :start_sphinx, :roles => :app do
  run "cd #{current_path} && rake thinking_sphinx:configure RAILS_ENV=production && rake thinking_sphinx:start RAILS_ENV=production"
end

task :index_sphinx, :roles => :app do
  run "cd #{current_path} && rake thinking_sphinx:index RAILS_ENV=production"
end

task :restart_sphinx, :roles => :app do
  stop_sphinx
  start_sphinx
end

task :update_bundler do
  #run "bundle install --gemfile #{release_path}/Gemfile"
  #run "cd #{release_path} && bundle exec rake db:migrate RAILS_ENV=production && bundle exec rake db:seed RAILS_ENV=production"
end

task :backup_db do
  run "pg_dump -U postgress cakeside_production -f #{filename}"
end

task :restore_db do
  run "psql -U postgress -d #{destination_db} -f #{dumpfile}"
end

